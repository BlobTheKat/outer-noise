const {instance: {exports}, module} = await WebAssembly.instantiate(Uint8Array.from(atob('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'), c => c.charCodeAt()))
export const seed = new Int32Array(8)
const mem = new DataView(exports.memory.buffer)
const sd = +exports.seed, off = +exports.offsets
const ch = new Uint8Array(exports.memory.buffer, +exports.chunk, 512)
export const chunk = new Int32Array(exports.memory.buffer, +exports.chunk2, 4096)

export function genNoise(cb, x, y, localSeed = 0){
	for(let yi=0,j=off;yi<65;yi+=16) for(let xi=0;xi<65;xi+=16,j+=4) mem.setFloat32(j, cb(x+xi, y+yi), true)
	exports.fillNoise(x, y, localSeed)
	return ch
}
export function genNoisev(arr, x, y, localSeed = 0){
	for(let j=0;j<25;j++) mem.setFloat32(off+(j<<4), arr[j], true)
	exports.fillNoise(x, y, localSeed)
	return ch
}

export function expand(noise, a = 0, b = 0){
	chunk[0] = a; chunk[1] = b
	ch.set(noise)
	exports.expand()
}

const enc = new TextEncoder(), {imul} = Math
export function setSeed(str){
	if(str instanceof ArrayBuffer) return void(sd.set(new Int32Array(sd, 0, 8)))
	const arr = enc.encode(str+'\0')
	seed.fill(0)
	let x = 0xe336beb9|0, i = 0
	let coeff = 1597334673
	// Quick bijective hash
	for(; i < arr.length; i += 4){
		const y = arr[i]<<24|arr[i+1]<<16|arr[i+2]<<8|arr[i+3]
		x = imul(x ^ imul(y, coeff), 0x7feb352d)
		x ^= x >> 15
		coeff += 0x4319fa62
		seed[(i>>2)&7] ^= x
	}
	let j = i >>= 2; coeff = 1
	do{
		x = imul(x, coeff += 0x6eeb828a)
		x ^= x >> 15
		seed[j = j+1&7] ^= x
	}while(j != i)
	for(let i=0,j=sd;i<8;i++,j+=4) mem.setInt32(j, seed[i], true)
}

export function getSeedHash(){
	let x = ''
	for(const i of seed) x += (i>>>0).toString(16).padStart(8, '0')
	return x
}